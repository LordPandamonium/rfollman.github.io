<html>
	<head>
		<title>More Javascript</title>
		<link rel="stylesheet" href="main-php.css">
		<script>
			var users = [
				{
					"First": "Rebecca",
					"Last": "Follman",
					"User ID": "rfollman",
					"Date of Login": "02/01/18",
					"City": "Washington"
				},
				{
					"First": "Susan",
					"Last": "Parks-Hoehn",
					"User ID": "sparks",
					"Date of Login": "01/15/18",
					"City": "Tallahassee"
				},
				{
					"First": "Zola",
					"Last": "Hoehn",
					"User ID": "zola524",
					"Date of Login": "02/10/18",
					"City": "Gainesville"
				}
			];
		</script>
	</head>
	<body>
		<div class="content">
		<h1>Javascript Functions</h1>
<!-- 		<h2>People Table</h2>
<table id="people"></table><br><br> -->
		<h2>New People Table</h2>
		<table>
			<thead>
				<tr><th>Name</th><th>User ID</th><th>First Login</th><th>City</th><th>Days Since Last Login</th></tr>
			</thead>
			<tbody id="newpeople">
				
			</tbody>
		</table>
		
		<script>
			/*http://www.rgagnon.com/jsdetails/js-0143.html*/
			/*http://javascriptissexy.com/understand-javascripts-this-with-clarity-and-master-it/*/
			/*https://www.w3schools.com/js/tryit.asp?filename=tryjs_event_onclick2*/
			function hideRow(obj) {
				
				obj.style.display = 'none';
			}

			/*suggestions from https://www.htmlgoodies.com/html5/javascript/calculating-the-difference-between-two-dates-in-javascript.html*/
			function dateCalc(d) {
				var oneDay = 1000 * 60 * 60 * 24;
				var month = d.split("/")[0] - 1,
					day = d.split("/")[1],
					year = d.split("/")[2]
				if (year.length == 2) {year = '20' + year;}
				date1 = new Date(year, month, day);
				var date1_ms = date1.getTime();
				var date2 = new Date();
				var date2_ms = date2.getTime();
				var diff_ms = date2_ms - date1_ms;
				return Math.round(diff_ms/oneDay);
			}
			
			var text = "";
			var newtext = "";
			var totdays = 0;
			for (var x in users) {
				if (users.hasOwnProperty(x)) {
					var obj = users[x];
					for (var y in obj) {
						if (obj.hasOwnProperty(y)) {
							text += "<tr><td align='right'>" + y + "</td><td>" + obj[y] + "</td></tr>";
						}
					}
					newtext += "<tr onclick='hideRow(this)'><td>" + obj['First'] + " " + obj['Last'] + "</td><td>" + 
						obj['User ID'] + "</td><td>" + 
						obj['Date of Login'] + "</td><td>" +
						obj['City'] + "</td><td align='center' class='num'>" +
						dateCalc(obj['Date of Login']) + "</td></tr>";
					totdays += dateCalc(obj['Date of Login']);
				}
			}
			newtext += "<tr><td colspan='4'>Total Days</td><td align='center' class='totnum'>" + totdays + "</td></tr>";
			/*document.getElementById("people").innerHTML = text;*/
			document.getElementById("newpeople").innerHTML = newtext;
		</script>
</div>
	</body>
</html>
